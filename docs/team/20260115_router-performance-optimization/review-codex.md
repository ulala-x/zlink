# 계획 검증 (Codex)

## 결론
- **최종 판단: 수정필요**  
  기본 구조는 실행 가능하지만, 성공 기준/검증 방법의 명확화와 리스크 대응 항목 보강이 필요하다.

## 1. 계획이 실행 가능한지
- **부분적으로 실행 가능**. 단계 구성과 우선순위는 타당하다.
- **전제 조건 보강 필요**: libzmq-ref 빌드 및 동일 벤치마크 프레임워크 확보가 선행되어야 한다.
- **환경 통제 상세 부족**: CPU 고정, governor, NUMA, 백그라운드 프로세스 통제 항목이 단계 0에 명시돼야 실행력이 높아진다.

## 2. 빠진 내용이 없는지
누락/보완 필요 항목:
- **성공 기준**: 목표 성능 격차 축소 폭(예: ROUTER -32%~-43% → -10% 이하) 및 각 단계별 종료 조건 필요.
- **회귀 검증**: 다른 패턴(PAIR/PUBSUB/DEALER) 및 큰 메시지 영향 확인 절차 명시 필요.
- **데이터 관리**: 결과 파일명 규칙, 저장 위치, 반복 횟수와 표준편차 기준 등 재현성 규칙 필요.
- **변경 통제**: 최적화 단계별로 롤백/비교 기준 버전 태깅 또는 git 기준점 지정 필요.

## 3. review-initial.md의 보완사항이 적절한지
- **대체로 적절**: 단계 0(빌드/벤치 동일화), 단계 1(비교 대상 파일), 단계 2(프로파일링 예시) 보완은 실행력 향상에 유효하다.
- **추가 제안**: “벤치마크 통일”을 구체화하여 zlink와 libzmq-ref 동일 바이너리/옵션 사용 또는 동일 스크립트 파라미터 표준화 명시 필요.
- **도구 확인**: perf 설치만으로는 flamegraph 생성이 불완전할 수 있으므로 설치/경로 확인 절차도 포함해야 한다.

## 4. 각 단계의 검증 방법이 명확한지
- **일부 모호**: “재실행 후 결과 확인” 수준으로 남아 있어 수치 기준이 불명확하다.
- **보완 필요**:
  - 단계 0: 동일 파라미터/동일 바이너리로 N회 실행, 평균/표준편차 기록.
  - 단계 1: 차이점 목록을 “성능 영향 가능성 순서”로 분류하여 검증 우선순위 결정.
  - 단계 3~5: 성능 개선 목표치를 명시하고, 이전 단계 대비 변화폭을 기록하는 형식 정의.
  - 회귀 테스트: `ctest` 혹은 `make check` 수행 여부 포함.

## 5. 리스크 대응 방안이 충분한지
- **부분적으로 부족**: 플랫폼 차이/ASIO 한계는 다루지만, 성능 회귀/측정 편차에 대한 대응이 미흡하다.
- **추가 리스크 제안**:
  - **측정 편차/소음**: 반복 실행 및 표준편차 기준 초과 시 재측정 규칙.
  - **최적화 부작용**: 메시지 순서 보장/메모리 사용량 증가 등 기능 회귀 대응 절차.
  - **도구 오버헤드**: perf/trace 실행 시 오버헤드가 큼 → 측정 모드 분리(정상/프로파일링).

## 수정 제안 요약
- 단계별 **성공 기준 및 종료 조건** 추가.
- **검증 방법 수치화**(N회 반복, 평균/표준편차, 개선율 기준).
- **회귀 테스트 및 롤백 기준** 명시.
- **리스크 대응**: 측정 편차, 기능 회귀, 도구 오버헤드 대응 항목 보강.
